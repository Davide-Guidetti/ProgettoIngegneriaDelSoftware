<!DOCTYPE html>
<html lang="it">
<head>
	<title>AZUDU</title>
	<meta charset="utf-8">

	<!-- script for usage of bootstrap, with jquery-->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script src="http://cdn.rawgit.com/Eonasdan/bootstrap-datetimepicker/a549aa8780dbda16f6cff545aeabc3d71073911e/src/js/bootstrap-datetimepicker.js"></script>
	<link href="http://cdn.rawgit.com/Eonasdan/bootstrap-datetimepicker/a549aa8780dbda16f6cff545aeabc3d71073911e/build/css/bootstrap-datetimepicker.css" rel="stylesheet"/>

	
	<script type="text/javascript" src="jquery-v3.5.1.min.js"></script>
	
	<script>
		var comitato;
		function getComitato(){
			$.ajax({
				url: '/MyTemplate/servletcontroller', //server per effettuare la query dei volontari in base alle competenze
				async: false, //non rende asincrona la richiesta, in questo modo si caricano correttamente le competenze
				type: 'post',
				data: {
					email: "giorgio.mocci@studio.unibo.it",
					getComitato: true
				},
				success: function (Obj) {
						console.log("ho ricevuto "+Obj);
						comitato=Obj;
				}
			});
		}
		getComitato();
	
	
		function DefineTable(){
			//here request Ajax to server to see compatible plan
			
			$.ajax({
				url: '/MyTemplate/servletcontroller', //server per effettuare la query dei volontari in base alle competenze
				type: 'post',
				data: {
					email: "giorgio.mocci@studio.unibo.it",
					isApprove: comitato
				},
				success: function (Obj) {
						console.log("isApprove "+Obj.split(",")[0]+" "+Obj.split(",")[1]);
						if (Obj.split(",")[0] == "true"){					
							if (Obj.split(",")[1] == "false"){ //non è coordinatore
								$("#collapsibleNavbar").html("<ul class=\"navbar-nav\"><li class=\"nav-item\"><a class=\"navbar-brand\">Piani compatibili</a></li></ul><ul class=\"navbar-nav ml-auto\"><li class=\"nav-item\"><a class=\"nav-link\" href=\"http://localhost:8080/MyTemplate/pages/azudo/ModificaDati.html\">Profilo</a></li></ul>");
							}else{ //è un coordinatore
								$("#collapsibleNavbar").html("<ul class=\"navbar-nav\"><li class=\"nav-item\"><a class=\"nav-link\" href=\"http://localhost:8080/MyTemplate/pages/azudo/PannelloGestionePiani.html\">Pannello gestione piani</a></li><li class=\"nav-item\"><a class=\"nav-link\" href=\"http://localhost:8080/MyTemplate/pages/azudo/approvaVolontari.html\">Gestione volontari comitato</a></li><li class=\"nav-item\"><a class=\"navbar-brand\">Piani compatibili</a></li><li class=\"nav-item\"><a class=\"nav-link\" href=\"http://localhost:8080/MyTemplate/pages/azudo/listaVolontari.html\">Lista volontari</a></li></ul><ul class=\"navbar-nav ml-auto\"><li class=\"nav-item\"><a class=\"nav-link\" href=\"http://localhost:8080/MyTemplate/pages/azudo/ModificaDati.html\">Profilo</a></li></ul>");								
							}
						}
						else{ //non è approvato
							$("#collapsibleNavbar").html("<ul class=\"navbar-nav ml-auto\"><li class=\"nav-item\"><a class=\"nav-link\" href=\"http://localhost:8080/MyTemplate/pages/azudo/ModificaDati.html\">Profilo</a></li></ul>");
						}
				}
			});
			
			dim=5;
			for (let i=1;i<=dim;i++ ){
				document.getElementById("bodyTable").innerHTML+="<tr><tr><td>PIANO "+i+"</td><td><a href=\"http://localhost:8080/MyTemplate/pages/azudo/partecipaPiano.html\"> <button onclick=\"myFunction()\" type=\"button\" class=\"btn btn-secondary btn-sm\">Vai</button></a></td></tr></tr>";
			}

		}
	</script>

</head>
<body onload="DefineTable()">
	<!-- Title -->
	<div class="jumbotron text-center" style="margin-bottom:0">
		<h1>AZUDU</h1>
		<!--<p></p> -->
	</div>

	<!-- navbar-->
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
		<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
		</div>  
	</nav>
	<br>
	<!--table-->
	<div class="container" style="margin-top:30px">
		<div >
		  <h2>PIANI DISPONIBILI COMPATIBILI</h2>
		  <br>
		  <table class="table">
			<thead class="thead-dark">
			  <tr>
				<th colspan="2" scope="col">Seleziona Piano</th>
			  </tr>
			</thead>
			<tbody id="bodyTable">
			</tbody>
		  </table>
		</div>
		<br>
	</div>

	<!--footer-->
	<div class="jumbotron text-center" style="margin-bottom:0">
		<h2>Footer</h2>
	</div>
	  
	
</body>
</html>
